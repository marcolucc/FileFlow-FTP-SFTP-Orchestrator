# /ftp/vsftpd.conf
#
# Main configuration for the vsftpd server.

# --- Server Settings ---
listen=YES
listen_ipv6=NO
anonymous_enable=NO
local_enable=YES
write_enable=YES
dirmessage_enable=YES
use_localtime=YES
xferlog_enable=YES
connect_from_port_20=YES
xferlog_std_format=YES

# --- Docker Compatibility ---
background=NO
seccomp_sandbox=NO

# --- VIRTUAL USER AUTHENTICATION ---
guest_enable=YES
guest_username=vsftpd
virtual_use_local_privs=YES
pam_service_name=vsftpd
user_sub_token=$USER

# --- Security & Jails (Chroot) ---
chroot_local_user=YES
allow_writeable_chroot=YES
# **FIX**: Explicitly define the secure chroot directory.
secure_chroot_dir=/var/run/vsftpd/empty

# --- Per-User Configuration ---
user_config_dir=/etc/vsftpd/user_conf

# --- Passive Mode Configuration ---
pasv_enable=YES
pasv_min_port=30000
pasv_max_port=30009

# --- IP Whitelisting ---
# tcp_wrappers=YES
